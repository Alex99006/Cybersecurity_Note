## ==CVE-2021-41773==

 是一个高危的路径遍历和文件泄露漏洞，影响 **Apache HTTP Server 2.4.49 版本**。

------



### 漏洞概述



- **漏洞类型：** 路径遍历（CWE-22）和文件泄露。在某些配置下，它还可能导致远程代码执行（RCE）。
- **受影响版本：** Apache HTTP Server 2.4.49。
- **成因：** Apache HTTP Server 2.4.49 中路径规范化过程的缺陷允许攻击者利用路径遍历攻击（例如，使用 `../` 或其 URL 编码的等效形式 `.%2e/`）将 URL 映射到 Alias 类指令配置目录之外的文件。
- **影响：**
  - **文件泄露：** 攻击者可以未经授权地访问服务器上的敏感文件（例如 `/etc/passwd`）。
  - **远程代码执行 (RCE)：** 如果配置目录之外的文件没有受到默认的 "require all denied" 配置保护，并且这些别名路径启用了 CGI 脚本，攻击者就可以在服务器上执行任意代码。
- **利用情况：** 该漏洞在发现后不久就已被积极利用。公开的概念验证（PoC）漏洞利用代码也广泛可用。

------



### 修复与缓解



- **修复版本：** Apache 在 **Apache HTTP Server 2.4.50** 中发布了修复程序。然而，此修复被发现不完整，后来被单独跟踪为另一个漏洞 **CVE-2021-42013**，该漏洞也允许路径遍历和 RCE。针对 CVE-2021-41773 和 CVE-2021-42013 的完整修复已在 **Apache HTTP Server 2.4.51** 中发布。
- **缓解措施：**
  - 主要建议是**将 Apache HTTP Server 更新到 2.4.51 或更高版本**。
  - 如果无法立即更新，请确保所有不打算公开访问的目录都实施了 `Require all denied` 指令。这应应用于所有目录，并且**绝不能**在没有适当限制的情况下应用于根目录。
  - 如果 `mod_cgi` 模块对于业务运营并非必不可少，请禁用它，因为它的启用可能会将漏洞升级为 RCE。
  - 考虑使用 Web 应用程序防火墙（WAF）来帮助检测和阻止利用尝试。