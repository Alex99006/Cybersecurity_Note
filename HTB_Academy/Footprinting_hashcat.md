### 一、 `hashcat` 的基本使用方法



`hashcat` 的基本命令结构如下：

```apl
hashcat [选项] [哈希文件或哈希字符串] [字典文件或掩码]
```

- **`[选项]`**: 用于控制 `hashcat` 的行为，例如指定哈希类型、攻击模式、工作负载等。
- **`[哈希文件或哈希字符串]`**: 这是你要破解的哈希值来源。你可以提供一个包含哈希值的文件，也可以直接在命令行中提供一个哈希字符串（用引号包裹）。
- **`[字典文件或掩码]`**: 这是用来尝试破解哈希的“密码”来源。可以是包含常见密码的字典文件，也可以是用来生成密码组合的掩码。

------



### 二、 `-m` 参数：哈希类型 (Hash Type)



`-m` 是 `hashcat` 中最重要的参数之一，它告诉 `hashcat` 你正在尝试破解哪种类型的哈希。每个 `-m` 后面的数字都对应着一种特定的哈希算法。

**要查看完整的哈希类型列表，你可以运行以下命令：**

```apl
hashcat --help
```

或者

```apl
hashcat --help | grep "Hash.Modes"
```

这会列出所有支持的哈希模式，并按数字编号。由于列表非常庞大，我将为你整理一些最常见、最重要的类型，并按类别说明其用途。



#### 常见哈希类型及其用途示例：



| `-m` 参数 | 哈希类型                    | 说明                                     | 使用场景                                                     |
| --------- | --------------------------- | ---------------------------------------- | ------------------------------------------------------------ |
| **0**     | MD5                         | 最常见的哈希算法之一，但已不安全。       | 破解老旧系统、数据库或一些网页服务的密码。                   |
| **100**   | SHA1                        | 曾经广泛使用的哈希算法，已被认为不安全。 | 破解 Git, SVN 等版本控制系统的密码。                         |
| **500**   | R-SHA1                      | Wordpress 哈希                           | 破解旧版 Wordpress 网站的密码。                              |
| **1000**  | NTLM                        | Windows NT LAN Manager 哈希              | 破解 Windows 本地用户或域用户的密码。                        |
| **1100**  | NTLMv2                      | Windows NT LAN Manager Version 2 哈希    | Windows 域环境中的现代 NTLM 认证。                           |
| **13100** | Kerberos 5 TGS-REP etype 23 | Kerberos 票据哈希                        | 渗透测试中进行 Kerberoasting 攻击，破解服务账户密码。        |
| **7300**  | IPMI2 RAKP HMAC-SHA1        | IPMI 协议的哈希                          | 破解服务器远程管理接口（IPMI）的密码。                       |
| **1700**  | WPA/WPA2                    | Wi-Fi 握手包哈希                         | 破解 Wi-Fi 网络密码。需要先用 `aircrack-ng` 等工具捕获握手包。 |
| **2500**  | WPA-EAPOL-PBKDF2            | WPA/WPA2 (PBKDF2-HMAC-SHA1) 哈希         | 另一种 Wi-Fi 密码哈希类型。                                  |
| **22000** | WPA-PMKID-PBKDF2            | WPA/WPA2 (PMKID) 哈希                    | 一种快速破解 Wi-Fi 的攻击类型。                              |
| **300**   | MySQL323                    | 旧版 MySQL 哈希                          | 破解旧版本 MySQL 数据库的用户密码。                          |
| **900**   | MySQL SHA1                  | MySQL `*SHA1` 哈希                       | 破解使用 `password()` 函数生成的 MySQL 密码。                |
| **1800**  | SHA-512 crypt               | Linux `crypt()` 哈希                     | 破解 Linux 系统 `/etc/shadow` 文件中的密码。                 |
| **10400** | Adobe PDF 1.7 (Acrobat 9)   | PDF 文档密码                             | 破解受密码保护的 PDF 文件。                                  |
| **13800** | KeePass 1 (AES and Twofish) | KeePass 密码库哈希                       | 破解 KeePass 密码管理器的主密码。                            |
| **13750** | bcrypt                      | 通用密码哈希算法                         | 破解使用 bcrypt 算法的应用密码。                             |
| **9900**  | eCryptfs                    | Linux 文件系统加密哈希                   | 破解加密文件系统的密码。                                     |

导出到 Google 表格

**如何选择 `-m` 参数？** 你需要先确定你要破解的哈希是来自哪里。例如：

- 如果你是从 Windows 服务器的 SAM 文件中导出的哈希，你可能会选择 `-m 1000` 或 `-m 1100`。
- 如果你是从 Linux 的 `/etc/shadow` 文件中导出的，你需要根据哈希的格式来选择，例如 `$6$......` 对应的就是 `-m 1800`。
- 如果你是从一个网站的数据库中导出的，你需要知道该网站使用的是哪种哈希算法。

------



### 三、 `-a` 参数：攻击模式 (Attack Mode)



`-a` 参数用于指定 `hashcat` 如何生成密码来尝试破解。

| `-a` 参数 | 模式名称               | 说明                                                       | 示例用法                                                     |
| --------- | ---------------------- | ---------------------------------------------------------- | ------------------------------------------------------------ |
| **0**     | Straight (字典攻击)    | 逐一使用字典文件中的单词。这是最常用和最有效的模式。       | `hashcat -m 1000 myhash.txt /usr/share/wordlists/rockyou.txt` |
| **1**     | Combination (组合攻击) | 将两个字典文件的所有单词进行两两组合。                     | `hashcat -m 1000 myhash.txt dict1.txt dict2.txt`             |
| **3**     | Mask (掩码攻击)        | 通过掩码模板生成所有可能的密码。适用于密码结构已知的场景。 | `hashcat -m 1000 myhash.txt -a 3 ?d?d?d?d`                   |
| **6**     | Hybrid Dict + Mask     | 将字典中的单词与掩码进行组合。                             | `hashcat -m 1000 myhash.txt dict.txt ?d?d`                   |





### 四、其他重要参数



- **`-o <文件>`**: `--outfile`，将破解结果（哈希:密码）保存到指定文件中，而不是只打印到终端。
- **`--show`**: 用于显示 `potfile` 文件中已破解的哈希。这个命令通常在破解任务完成后使用。
- **`-w <数字>`**: `--workload-profile`，设置工作负载级别，控制 GPU 的使用率。
  - `1` (低): 适用于同时进行其他任务。
  - `2` (默认): 平衡模式。
  - `3` (高): 最大化性能，可能影响系统响应。
- **`-O`**: `--optimized-kernel-enable`，启用优化的内核以提高破解速度。对于很多哈希类型，这是一个非常有用的性能选项。
- **`--force`**: 强制运行 `hashcat`，即使它检测到潜在问题（如驱动程序版本过旧）。
- **`--session <名称>`**: 启动一个会话，可以保存进度。如果你需要中断破解任务并在以后恢复，这个选项非常重要。使用 `-s` 或 `-i` 来恢复中断的会话。

------



### `hashcat` 使用流程示例



一个典型的密码破解流程如下：

1. **获取哈希**：从目标系统（如 `/etc/shadow`、`SAM` 文件）或网络流量中转储哈希。

2. **确定哈希类型**：通过哈希的格式（例如 `$1$`, `$6$`, `*SHA1`）来判断，然后选择正确的 `-m` 参数。

3. **开始破解**：

   - **首先进行字典攻击**（`-a 0`），因为弱密码最常见。

     ```apl
     hashcat -m 1000 myhash.txt /usr/share/wordlists/rockyou.txt -w 3 -O -o cracked.txt
     ```

   - **如果字典攻击失败，再尝试掩码攻击**（`-a 3`），根据你的猜测来缩小范围。

     ```apl
     # 尝试所有6位数字密码
     hashcat -m 1000 myhash.txt -a 3 ?d?d?d?d?d?d -w 3 -o cracked_mask.txt
     ```

4. **查看结果**：在破解成功后，使用 `--show` 命令查看结果。

   ```apl
   hashcat -m 1000 myhash.txt --show
   ```

### ==注意--例==

~~~apl
hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?
~~~

### 命令分解

1. **`hashcat`**
   - 这是一个开源的密码破解工具，以其强大的性能（支持 GPU 加速）和灵活的攻击模式而闻名。
2. **`-m 7300`**
   - 这是 `hashcat` 的一个核心选项，用于指定要破解的**哈希类型（hash type）**。
   - `-m` 后面的数字 `7300` 对应着特定的哈希算法。
   - **`7300`** 代表 **IPMI2 RAKP HMAC-SHA1**。这是 IPMI v2.0 协议中用于远程认证的哈希算法。IPMI (Intelligent Platform Management Interface) 是一种用于管理服务器硬件的协议。
3. **`ipmi.txt`**
   - 这是包含要破解的**哈希值的文件名**。
   - 在 IPMI 渗透测试中，这个文件通常是通过专门的工具（如 Metasploit 的 `ipmi_dumphashes` 模块或 `ipmi-tool`）从目标设备转储出来的。这个文件里包含了 IPMI 用户的哈希密码。
4. **`-a 3`**
   - 这是指定要使用的**攻击模式（attack mode）**。
   - `-a` 后面的数字 `3` 代表 **Mask Attack**，即**掩码攻击**。
   - 掩码攻击是通过定义一个**掩码模板**来生成所有可能的密码组合，然后用这些组合来破解哈希。这比纯粹的暴力破解更高效，因为你可以指定密码的长度、字符集和结构。
5. **`?1?1?1?1?1?1?1?1`**
   - 这是**掩码模板（Mask）**。
   - 掩码模板中的 `?` 后面跟着一个数字或字符，代表一个**字符集（charset）**。
   - 这里的 `?1` 是一个**自定义字符集**，它是由 `-1` 选项定义的。
   - 这里的掩码模板是 **8 个 `?1`**，这意味着 `hashcat` 将会生成所有 8 个字符长的密码，并且每个字符都来自 `-1` 定义的字符集。
6. **`-1 ?d?u`**
   - 这是**定义自定义字符集**的选项。
   - `-1` 代表**自定义字符集 1**。
   - `?d` 是 `hashcat` 内置的**数字字符集**（`0-9`）。
   - `?u` 是 `hashcat` 内置的**小写字母字符集**（`a-z`）。
   - 所以，`-1 ?d?u` 的意思是：**定义一个自定义字符集 `?1`，它包含所有数字和小写字母**。

------

### 综合含义

`hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u` 这条命令的完整意思是：

**“使用 hashcat 破解一个包含 IPMI2 RAKP HMAC-SHA1 哈希值的文件 `ipmi.txt`。破解方式是执行一个掩码攻击，生成所有由 8 个字符组成的密码，其中每个字符都来自一个包含所有数字和小写字母的自定义字符集。”**

